$(function(){var getToken,save2Server;return getToken=function(){return new Promise(function(resolve,reject){var keys;return keys=["token"],chrome.storage.sync.get(keys,function(item){return void 0===item.token||""===item.token?reject(void 0):resolve(item.token)})})},save2Server=function(post){var destUrl;return destUrl="https://ona-it-later.herokuapp.com/api/posts",getToken().then(function(token){return $.ajax({type:"POST",url:destUrl,data:{token:token,post:post},headers:{"Access-Control-Allow-Origin":"*"}}).done(function(data){return chrome.runtime.sendMessage({newIconPath:"build/images/blue/icon19.png"}),alertify.success("保存しました。")}).fail(function(err){return void 0})})["catch"](function(err){return alertify.error("トークンに誤りがあります。\nもう一度確認してみてください。")})},function(){var data,description1,description2,favicon,firstImgUrlInBody,hostName,siteImage,siteName,siteUrl1,siteUrl2,title1,title2;return alertify.log("保存中 ......"),data={},title1=$("head title").text(),title2=$('meta[property="og:title"]').attr("content"),data.title=title1||title2,siteName=$('meta[property="og:site_name"').text(),data.siteName=siteName,siteUrl1=$(location).attr("href"),siteUrl2=$('meta[property="og:url"]').attr("content"),data.siteUrl=siteUrl1||siteUrl2,null!=("undefined"!=typeof info&&null!==info?info.mediaType:void 0)&&"image"===info.mediaType?(data.url=info.srcUrl,data.type="image"):(firstImgUrlInBody=$("img").get(0).src,data.url=firstImgUrlInBody,data.type="link"),hostName=location.host,data.hostName=hostName,description1=$('meta[name="description"]').attr("content"),description2=$('meta[property="og:description"]').attr("content"),data.description=description1||description2,siteImage=$('meta[property="og:image"]').attr("content"),data.siteImage=siteImage,favicon=$('link[rel="shortcut icon"]').prop("href"),data.favicon=favicon,data.isPrivate=!0,data.isArchive=!1,save2Server(data)}()});